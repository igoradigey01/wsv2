<div class="mat-typography">
  <div class="_contaner">
    <div *ngIf="!_flag_sendServerData; else elseSendData">
      <!-- begin edit  card ------------------------------------->
      <form #myForm="ngForm" novalidate>
        <div class="_input-group">
          <label for="katalog" class="_label">Католог &nbsp; </label>
          <mat-form-field id="katalog" appearance="outline">
            <mat-label>
              <span class="_label_id"> id( {{ Product().subCatalogId }})</span
              >&nbsp; {{ Product().subCatalogName }}</mat-label
            >
            <input matInput name="katalogName" disabled />
          </mat-form-field>
        </div>

        <div class="_input-group">
          <label for="hiddenNomenclature" class="_label"> Скрыть </label>
          <mat-form-field id="hiddenNomenclature" appearance="fill">
            <div *ngIf="Product()">
              <mat-select
                name="hiddenNomenclature"
                [(ngModel)]="Product().hidden"
                #hiddenNomenclature="ngModel"
                required
              >
                <mat-option [value]="false">Нет </mat-option>
                <mat-option [value]="true">Да </mat-option>
              </mat-select>
              <mat-error *ngIf="hiddenNomenclature.invalid"> </mat-error>
            </div>
          </mat-form-field>
        </div>

        <div class="_input-group">
          <label for="saleNomenclature" class="_label"> Распродажа</label>
          <mat-form-field id="saleNomenclature" appearance="fill">
            <div *ngIf="Product()">
              <mat-select
                name="saleNomenclature"
                [(ngModel)]="Product().sale"
                #saleNomenclature="ngModel"
                required
              >
                <mat-option [value]="false">Нет </mat-option>
                <mat-option [value]="true">Да </mat-option>
              </mat-select>
              <mat-error *ngIf="saleNomenclature.invalid"> </mat-error>
            </div>
          </mat-form-field>
        </div>

        <div class="_input-group">
          <label for="inStokcNomenclature" class="_label"> На складе </label>
          <mat-form-field id="saleNomenclature" appearance="fill">
            <div *ngIf="Product()">
              <mat-select
                name="inStokcNomenclature"
                [(ngModel)]="Product().inStock"
                #inStokcNomenclature="ngModel"
                required
              >
                <mat-option [value]="false">Нет </mat-option>
                <mat-option [value]="true">Да </mat-option>
              </mat-select>
              <mat-error *ngIf="inStokcNomenclature.invalid"> </mat-error>
            </div>
          </mat-form-field>
        </div>

        <!--------------  Материал== t        -->
        <div class="_input-group">
          <label for="brand" class="_label"> Бренд </label>
          <mat-form-field id="brand" appearance="fill">
            <mat-select
              name="brand"
              (selectionChange)="onBrandChange($event)"
              [(ngModel)]="Product().brandId"
              #brand="ngModel"
              required
            >
              <mat-option *NgFor="let item of _brands" [value]="item.id">{{
                item.name
              }}</mat-option>
            </mat-select>
            <mat-error *ngIf="brand.invalid"> </mat-error>
          </mat-form-field>
        </div>

        <!-- idTypeProduct begin -->
        <div class="_input-group">
          <label for="color" class="_label"> Цвет</label>
          <mat-form-field id="color" appearance="fill">
            <mat-select
              name="color"
              [(ngModel)]="Product().colorId"
              (selectionChange)="onColorChange($event)"
              #color="ngModel"
              required
            >
              <mat-option *ngFor="let item of _colors" [value]="item.id">{{
                item.name
              }}</mat-option>
            </mat-select>
            <mat-error *ngIf="color.invalid"> </mat-error>
          </mat-form-field>
        </div>

        <div class="_input-group">
          <label for="article" class="_label"> Артикул </label>
          <mat-form-field id="article" appearance="fill">
            <mat-select
              name="article"
              (selectionChange)="onArticleChange($event)"
              [(ngModel)]="Product().articleId"
              #article="ngModel"
              required
            >
              <mat-option *ngFor="let item of _articles" [value]="item.id">{{
                item.name
              }}</mat-option>
            </mat-select>
            <mat-error *ngIf="article.invalid"> </mat-error>
          </mat-form-field>
        </div>

        <!--------------------------->
        <div class="_input-group">
          <mat-form-field
            id="nameNomenclature"
            class="_input-name"
            appearance="fill"
          >
            <mat-label>Название </mat-label>
            <span matPrefix
              >{{ Product().subCatalogName }} &nbsp;
              <span *ngIf="Product().brandName !== 'none'; else unbrand">
                {{ Product().brandName }}&nbsp;
              </span>
              <ng-template #unbrand>
                <span></span>
              </ng-template>

              <span *ngIf="Product().articleName !== 'none'; else unarticle">
                {{ Product().articleName }}&nbsp;
              </span>
              <ng-template #unarticle>
                <span></span>
              </ng-template>

              <span *ngIf="Product().colorName !== 'none'; else uncolor">
                {{ Product().colorName }}&nbsp;
              </span>
              <ng-template #uncolor>
                <span></span>
              </ng-template>
            </span>
            <input
              matInput
              name="productname"
              #nameNomenclature="ngModel"
              [(ngModel)]="Product().title"
            />
            <mat-error *ngIf="nameNomenclature.invalid"> </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field id="position" class="_input-price" appearance="fill">
          <mat-label>Позиция</mat-label>
          <input
            matInput
            name="position"
            [(ngModel)]="Product().position"
            #position="ngModel"
            required
            pattern="[0-9]{1}"
          />

          <mat-error *ngIf="position.invalid"> </mat-error>
        </mat-form-field>

        <mat-form-field
          id="PriceProduct"
          class="_input-price"
          appearance="fill"
        >
          <mat-label>Цена</mat-label>
          <input
            matInput
            name="pace_product"
            [(ngModel)]="Product().price"
            #price="ngModel"
            required
            pattern="[0-9]{1,7}"
          />
          <span matPrefix>₽ &nbsp;</span>
          <span matSuffix>.00</span>
          <mat-error *ngIf="price.invalid"> </mat-error>
        </mat-form-field>

        <mat-form-field
          id="markupProduct"
          class="_input-price"
          appearance="fill"
        >
          <mat-label>Торговая наценка</mat-label>
          <input
            matInput
            name="markup_product"
            [(ngModel)]="Product().markup"
            #markup="ngModel"
            required
            pattern="[0-9]{1,2}"
          />
          <span matPrefix>% &nbsp;</span>
          <mat-error *ngIf="markup.invalid"> </mat-error>
        </mat-form-field>

        <!------------------------------------>
        <div class="_input-group">
          <mat-form-field
            id="discription"
            class="_input-price"
            appearance="fill"
          >
            <mat-label>Описание товара</mat-label>
            <textarea
              name="description_product"
              matInput
              [(ngModel)]="Product().description"
              rows="5"
            >
            </textarea>
          </mat-form-field>
        </div>

        <!-----------img -render------------------------------------------>

        <wsv2-img-render
          [_img_name]="Product().guid"
          [_rootSrc]="Product().wwwroot"
          (_onChangedDtoImage)="onChangedDtoImage($event)"
          (_onFlagShowSaveDataBar)="onFlagButtonPanel($event)"
        ></wsv2-img-render>
        <!---- error render 10.02.22 -->
        <div class="alert alert-danger" role="alert" *ngIf="_errorMgs?.length">
          <ul>
            <li *ngFor="let error of _errorMgs">
              {{ error }}
            </li>
          </ul>
        </div>

        <!---------------  Botton edit start (  panel buttons  )    -->

        <div [ngClass]="{ show_ButtonsPanel: _flagButtonShow }">
          <div class="d-flex justify-content-center">
            <button
              *ngIf="!IsCreateView"
              mat-flat-button
              [disabled]="myForm.invalid || _flagInvalid || myForm.pristine"
              color="primary"
              (click)="saveIgnoreImgFromProduct()"
            >
              Сохранить Данные
            </button>

            <button
              *ngIf="!IsCreateView && _selectDtoImg.flagChanged"
              mat-flat-button
              [disabled]="myForm.invalid || _flagInvalid"
              color="primary"
              (click)="saveOnlyImgFromProduct()"
            >
              Сохранить Фото
            </button>
          </div>

          <div class="d-flex justify-content-center">
            <button
              mat-flat-button
              [disabled]="myForm.invalid || _flagInvalid || myForm.pristine"
              *ngIf="_selectDtoImg.flagChanged"
              color="primary"
              (click)="saveNomenclature()"
            >
              Сохранить
            </button>
            <button
              *ngIf="!IsCreateView"
              mat-flat-button
              color="warn"
              [disabled]="_flagInvalid"
              (click)="deleteNomenclature()"
            >
              Удалить
            </button>
            <button
              mat-flat-button
              color="accent"
              [disabled]="_flagInvalid"
              (click)="cancel()"
            >
              Отмена
            </button>
          </div>
        </div>
      </form>

      <!--button edit end-->
      <!---------ng-template #elseBlock end-------------------------------------------- -->
    </div>
    <!-- end  _flag_sendServerData-->
    <ng-template #elseSendData>
      <div class="_error" role="alert" *ngIf="_errorMgs?.length || _flagError">
        <ul>
          <li *ngFor="let error of _errorMgs">
            {{ error }}
          </li>
        </ul>
      </div>

      <div class="progress">
        <div
          class="progress-bar"
          role="progressbar"
          [style.width.%]="_progress"
        ></div>
      </div>
      <div class="row" style="text-align: center">
        <p>({{ _progress }})</p>
        <button mat-flat-button color="accent" (click)="undo()">Отмена</button>
        <button mat-flat-button color="primary" (click)="OK()">OK</button>
      </div>
    </ng-template>
  </div>
</div>
